import{b as U,e as oe,f as C,g as f,h as ae,i as se}from"./chunk-GEZB6BJ2.js";import{Ab as j,Ba as _,Bb as q,Cb as J,Db as K,Fb as X,Hb as Y,Ia as a,Ib as Z,Ja as s,Jb as ee,K as O,Ka as p,Kb as te,La as b,Lb as ie,Mb as re,Na as h,Nb as ne,O as x,Oa as m,Qa as d,R,Ra as P,Sa as L,U as v,V as y,Va as k,Wa as E,Xa as M,Ya as A,ha as w,m as T,nb as F,ob as B,pa as o,pb as z,qa as N,sa as V,ub as Q,v as I,vb as W,wa as l,wb as $,xb as G,yb as D,zb as H}from"./chunk-F2DUI6E4.js";var S=class{constructor(r=0,c=1,e="",i=[]){this.pageNum=r,this.pageSize=c,this.searchQuery=e,this.selectedCategories=i}toUrlParams(){let r=Object.assign({},this);if(r.pageNum=this.pageNum,r.pageSize=this.pageSize,this.searchQuery.replace(/\s/g,"")!=""&&(r.searchQuery=this.searchQuery),this.selectedCategories.length!=0){let c=this.selectedCategories.map(e=>e.id);r.excludedCategories=c.toString()}return r}};var le=(()=>{let r=class r{constructor(e){this.http=e,this.url=`${se.API_URL}/api/categories`}getCategories(e){let i=this.url,t=e.toUrlParams();return this.http.get(i,{params:t}).pipe(I(g=>(console.log(g),T(()=>new Error(`
          CategoryService.getCategories(params: CategoryRequestDTO): Observable<Page<Category>>;
          Error while attempting GET to ${i}.
          With params: ${JSON.stringify(t)}.
          ${g}
          `)))))}};r.\u0275fac=function(i){return new(i||r)(x(U))},r.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var ge=["accordion"],me=["first"];function pe(n,r){n&1&&(a(0,"div")(1,"h2",21),d(2,"Selected Categories"),s(),p(3,"hr"),s())}function ue(n,r){if(n&1){let c=b();a(0,"div",26)(1,"button",27),h("click",function(){v(c);let i=m().$implicit,t=m(2);return y(t.unselectCategory(i))}),d(2),s()()}if(n&2){let c=m().$implicit;o(2),P(c.name)}}function _e(n,r){n&1&&p(0,"hr")}function he(n,r){if(n&1&&(a(0,"div"),_(1,ue,3,1,"div",25)(2,_e,1,0,"hr",24),s()),n&2){let c=r.$implicit,e=m(2);o(),l("ngIf",e.categoryIsClean(c)),o(),l("ngIf",!e.categoryIsLast(c))}}function Ce(n,r){if(n&1&&(a(0,"div",23),_(1,pe,4,0,"div",24)(2,he,3,2,"div",22),s()),n&2){let c=m();o(),l("ngIf",c.categoryIsClean(c.categoryParams.selectedCategories[0])),o(),l("ngForOf",c.categoryParams.selectedCategories)}}function fe(n,r){n&1&&p(0,"br")}function Se(n,r){if(n&1){let c=b();a(0,"div")(1,"div",26)(2,"button",28),h("click",function(){v(c);let i=m().$implicit,t=m();return y(t.selectCategory(i))}),d(3),s()(),_(4,fe,1,0,"br",24),s()}if(n&2){let c=m().$implicit,e=m();o(3),P(c.name),o(),l("ngIf",!e.categoryIsLast(c))}}function ve(n,r){if(n&1&&(a(0,"div"),_(1,Se,5,2,"div",24),s()),n&2){let c=r.$implicit,e=m();o(),l("ngIf",e.categoryIsClean(c))}}var Qe=(()=>{let r=class r{constructor(e){this.categoryService=e,this.ordering={default:"NONE",MOST_POPULAR:"MOST_POPULAR",LEAST_POPULAR:"LEAST_POPULAR",MOST_REVIEWS:"MOST_REVIEWS",LEAST_REVIEWS:"LEAST_REVIEWS",MOST_RATINGS:"MOST_RATINGS",LEAST_RATINGS:"LEAST_RATINGS"},this.controlSubmitEvent=new V,this.searchParams=new oe(0,6),this.categoryParams=new S(0,6),this.sortOrder=this.ordering.default,this.categoryPage=new ae}ngOnInit(){this.reloadAll()}reloadAll(){this.reloadCategories(),this.updateOrdering(),this.setProductCategories(),this.emitEvent()}setProductCategories(){this.searchParams.categories=[...this.categoryParams.selectedCategories]}unselectCategory(e){let i=this.categoryParams.selectedCategories.filter(t=>t.id!==e.id&&t!==null&&t!==void 0);this.categoryParams.selectedCategories=i,this.reloadCategories()}selectCategory(e){this.categoryParams.selectedCategories.push(e),this.reloadCategories()}emitEvent(){this.setProductCategories(),this.controlSubmitEvent.emit(this.searchParams)}reloadCategories(){this.categoryService.getCategories(this.categoryParams).subscribe({next:e=>{this.categoryPage=Object.assign({},e)}})}updateOrdering(){let e,i;switch(this.sortOrder){case this.ordering.MOST_POPULAR:e=C.popularity,i=f.descending;break;case this.ordering.LEAST_POPULAR:e=C.popularity,i=f.ascending;break;case this.ordering.MOST_REVIEWS:e=C.reviews,i=f.descending;break;case this.ordering.LEAST_REVIEWS:e=C.reviews,i=f.ascending;break;case this.ordering.MOST_RATINGS:e=C.ratings,i=f.descending;break;case this.ordering.LEAST_RATINGS:e=C.ratings,i=f.descending;break;default:e=null,i=null}this.searchParams.groupBy=e,this.searchParams.orderBy=i}selectedIsEmpty(){return this.categoryParams.selectedCategories.length===0}categoryIsClean(e){return e!=null}categoryIsLast(e){return this.categoryPage.content[this.categoryPage.content.length-1]===e}isMobile(){return!window.matchMedia("(min-width: 768px)").matches}handleResize(e){let i=this.isMobile(),t=this.accordion.isExpanded("first");(!i&&!t||i&&t)&&this.accordion.toggle("first")}};r.\u0275fac=function(i){return new(i||r)(N(le))},r.\u0275cmp=R({type:r,selectors:[["app-products-controls-sidebar"]],viewQuery:function(i,t){if(i&1&&(M(ge,5),M(me,5)),i&2){let g;E(g=A())&&(t.accordion=g.first),E(g=A())&&(t.first=g.first)}},hostBindings:function(i,t){i&1&&h("resize",function(u){return t.handleResize(u)},!1,w)},outputs:{controlSubmitEvent:"controlSubmitEvent"},standalone:!0,features:[k],decls:55,vars:17,consts:[["ngbAccordion",""],["accordion","ngbAccordion"],["ngbAccordionItem","first",3,"collapsed"],["first","ngbAccordionItem"],["ngbAccordionHeader","",1,"p-sm-3"],["ngbAccordionButton","",3,"hidden"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],["accordianBody",""],[1,"p-sm-3","p-2"],["name","displayFilters"],[1,"selector"],["for","formControlRange"],["name","displayAmount",1,"custom-select","form-control",3,"ngModel","ngModelChange"],[3,"ngValue"],["name","orderBy",1,"custom-select","form-control",3,"ngModel","ngModelChange"],["for","customRange3",1,"form-label"],["type","range","min","0","max","5","step","0.5","name","customRange3",1,"form-range",3,"ngModel","ngModelChange"],["id","categories",1,"p-sm-3","p-2"],["id","selectedCategories",4,"ngIf"],["id","unselectedCategories"],[1,"mt-3"],[4,"ngFor","ngForOf"],["id","selectedCategories"],[4,"ngIf"],["class","category",4,"ngIf"],[1,"category"],[1,"category-selector","selected-category",3,"click"],[1,"category-selector",3,"click"]],template:function(i,t){i&1&&(a(0,"div",0,1)(2,"div",2,3)(4,"h2",4)(5,"button",5),d(6,"Filter & Sort"),s()(),a(7,"div",6)(8,"div",7,8)(10,"div",9)(11,"form",10)(12,"div",11)(13,"label",12)(14,"small"),d(15,"Display Per Page"),s()(),p(16,"br"),a(17,"select",13),h("ngModelChange",function(u){return t.searchParams.pageSize=u})("ngModelChange",function(){return t.emitEvent()}),a(18,"option",14),d(19,"6"),s(),a(20,"option",14),d(21,"9"),s(),a(22,"option",14),d(23,"18"),s(),a(24,"option",14),d(25,"32"),s()()(),p(26,"br"),a(27,"div",11)(28,"label",12)(29,"small"),d(30,"Sort By"),s()(),p(31,"br"),a(32,"select",15),h("ngModelChange",function(u){return t.sortOrder=u})("ngModelChange",function(){return t.updateOrdering()}),a(33,"option",14),d(34,"None"),s(),a(35,"option",14),d(36,"Most Popular"),s(),a(37,"option",14),d(38,"Least Popular"),s(),a(39,"option",14),d(40,"Most Reviews"),s(),a(41,"option",14),d(42,"Least Reviews"),s()()(),p(43,"br"),a(44,"div")(45,"label",16),d(46),s(),a(47,"input",17),h("ngModelChange",function(u){return t.searchParams.minRating=u})("ngModelChange",function(){return t.emitEvent()}),s()()()(),a(48,"div",18),_(49,Ce,3,2,"div",19),a(50,"div",20)(51,"h2",21),d(52,"Categories"),s(),p(53,"hr"),_(54,ve,2,1,"div",22),s()()()()()()),i&2&&(o(2),l("collapsed",t.isMobile()),o(3),l("hidden",!t.isMobile()),o(12),l("ngModel",t.searchParams.pageSize),o(),l("ngValue",6),o(2),l("ngValue",9),o(2),l("ngValue",18),o(2),l("ngValue",32),o(8),l("ngModel",t.sortOrder),o(),l("ngValue",t.ordering.default),o(2),l("ngValue",t.ordering.MOST_POPULAR),o(2),l("ngValue",t.ordering.LEAST_POPULAR),o(2),l("ngValue",t.ordering.MOST_REVIEWS),o(2),l("ngValue",t.ordering.LEAST_REVIEWS),o(5),L("Min Rating:\xA0",t.searchParams.minRating," Stars"),o(),l("ngModel",t.searchParams.minRating),o(2),l("ngIf",t.selectedIsEmpty()),o(5),l("ngForOf",t.categoryPage.content))},dependencies:[z,F,B,ne,ee,re,ie,te,Y,Z,X,H,J,K,Q,j,q,W,$,D,G],styles:[".category-selector[_ngcontent-%COMP%]{width:80%;word-wrap:break-word;background-color:inherit;border:none;font-size:large;font-weight:bolder}.category-selector[_ngcontent-%COMP%]:hover{font-size:1.3rem;transition:.2s;opacity:90%}.selected-category[_ngcontent-%COMP%]{text-align:start;color:purple}#categories[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{text-align:start}"]});let n=r;return n})();export{Qe as ProductsControlsSidebarComponent};
